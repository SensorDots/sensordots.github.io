<!DOCTYPE html><html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# schema: http://schema.org/ sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# ">
<!-- Mirrored from sensordots.org/mappydotcalibration by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 Aug 2022 12:43:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8" /><meta name="description" content="MappyDot Calibration
The VL53L0X has 4 different calibration modes which implement the standard VL53L0X API calibration routines. More information about these calibration functions can be found in the ST VL53L0X API documentation." /><meta name="keywords" content="SensorDots Sensor Dots Small Smart Simple Sensors Filtering Polling Crosstalk Automatic Address Addressing Bus Easy Processing" /><meta name="Generator" content="Drupal 8 (https://www.drupal.org)" /><meta name="MobileOptimized" content="width" /><meta name="HandheldFriendly" content="true" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="sites/default/files/favicon.ico" type="image/vnd.microsoft.icon" /><link rel="canonical" href="mappydotcalibration.html" /><link rel="shortlink" href="node/27.html" /><link rel="revision" href="mappydotcalibration.html" /><title>MappyDot Calibration | SensorDots</title><link rel="stylesheet" media="all" href="sites/default/files/css/css_5L2WsNWFakAaziUfa6TbCSyUCD8jJhLtnSAg4JB8c1s.css" /><link rel="stylesheet" media="all" href="sites/default/files/css/css_TqP0rzTeinXkupgUr1mR41ebkMj_f9DCOzD1rEBC4ZY.css" /> <!--[if lte IE 8]><script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script><![endif]--></head><body class="path-node page-node-type-page"> <a href="#main-content" class="visually-hidden focusable skip-link"> Skip to main content </a><div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas> <header class="main-header"> <nav class="navbar navbar-default" role="navigation"><div class="container"><div class="row"><div class="navbar-header col-md-3"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><div class="region region-header"><div id="block-drupal8-zymphonies-theme-branding" class="site-branding block block-system block-system-branding-block"><div class="brand logo"> <a href="index.html" title="Home" rel="home" class="site-branding__logo"> <img src="sites/default/files/logo-big.png" alt="Home" /> </a></div></div></div></div><div class="col-md-9"><div class="region region-primary-menu"><div class="search-block-form block block-search" data-drupal-selector="search-block-form" id="block-drupal8-zymphonies-theme-search" role="search"><h2 class="visually-hidden">Search</h2><form action="http://sensordots.org/search/node" method="get" id="search-block-form" accept-charset="UTF-8"><div class="js-form-item form-item js-form-type-search form-item-keys js-form-item-keys form-no-label"> <label for="edit-keys" class="visually-hidden">Search</label> <input title="Enter the terms you wish to search for." data-drupal-selector="edit-keys" type="search" id="edit-keys" name="keys" value="" size="15" maxlength="128" class="form-search" /></div><div data-drupal-selector="edit-actions" class="form-actions js-form-wrapper form-wrapper" id="edit-actions"><input data-drupal-selector="edit-submit" type="submit" id="edit-submit" value="Search" class="button js-form-submit form-submit" /></div></form></div><nav role="navigation" aria-labelledby="block-drupal8-zymphonies-theme-main-menu-menu" id="block-drupal8-zymphonies-theme-main-menu"><h2 class="visually-hidden" id="block-drupal8-zymphonies-theme-main-menu-menu">Main navigation</h2><ul class="sm menu-base-theme" id="main-menu" class="menu nav navbar-nav"><li class="active"> <a href="index.html" data-drupal-link-system-path="&lt;front&gt;">Home</a></li><li> <a href="about.html" data-drupal-link-system-path="node/2">About</a></li><li> <a href="https://www.tindie.com/stores/blecky/">Store</a></li><li> <a href="dots.html" data-target="#" data-toggle="dropdown">Dots</a><ul><li> <a href="mappydot.html" data-drupal-link-system-path="node/3">MappyDot</a></li><li> <a href="mappydot_plus.html" data-drupal-link-system-path="node/32">MappyDot+</a></li></ul></li><li> <a href="tools.html" data-target="#" data-toggle="dropdown">Tools</a><ul><li> <a href="devboard.html" data-drupal-link-system-path="node/9">Dev Board</a></li><li> <a href="mounting_board.html">Mounting Board</a></li><li> <a href="port_multiplexer.html">Port MuxR</a></li></ul></li><li> <a href="docs.html">Docs</a></li><li> <a href="https://github.com/SensorDots">Repo</a></li><li> <a href="https://hackaday.io/project/25571-mappydot">Blog</a></li></ul> </nav></div></div></div></div> </nav> </header><div class="container"><div class="row"><div class="col-md-12"><div class="region region-highlighted"><div data-drupal-messages-fallback class="hidden"></div></div></div></div></div><div id="wrapper"><div class="container"><div class="row"><div class="col-md-12"></div></div><div class="row layout"><div class="content_layout"><div class=col-md-12><div class="region region-content"><div id="block-drupal8-zymphonies-theme-content" class="block block-system block-system-main-block"> <article data-history-node-id="27" role="article" about="/mappydotcalibration" typeof="schema:WebPage" class="node node--type-page node--view-mode-full"> <span property="schema:name" content="MappyDot Calibration" class="hidden"></span><div class="node__content"><div property="schema:text"><h2>MappyDot Calibration</h2><p>The VL53L0X has 4 different calibration modes which implement the standard VL53L0X API calibration routines. More information about these calibration functions can be found in the <a href="https://github.com/SensorDots/MappyDotFirmware/raw/master/MappyDot/vl53l0x/en.DM00279088.pdf">ST VL53L0X API</a> documentation.</p><ul><li><span class="fontstyle0">Reference SPADs calibration - </span><span class="fontstyle0">Calibrates the SPAD arrays.</span></li><li><span class="fontstyle0">Temperature calibration - Temperature </span><span class="fontstyle0">calibration adjusts the device sensitivity when the temperature changes. This is performed at startup and should be performed again when the temperature varies by more than 8 degrees Celcius.</span></li><li><span class="fontstyle0">Offset calibration - Calibrates the offset of the sensor. This should be performed after assembly (including the glass cover).</span></li><li><span class="fontstyle0">Cross-talk calibration - Calibrates the "cross-talk" that is received from a close reflected surface such as a glass cover on the sensor. This must be performed if using a clear cover on the sensor or an aperture that restricts the viewing angle of the sensor. </span> <span class="fontstyle0">More information about calibration with a glass cover is detailed in this <a href="sites/default/files/misc/en.DM00326504.pdf">application note</a>.</span></li></ul><p><span class="fontstyle0">The MappyDot will automatically switch to single ranging mode to perform these calibration routines. The targets discussed here are standard Munsell neutral chart values </span>(Grey 17% N4.74, White 88% N9.5):</p><table border="1" height="102" width="234"><tbody><tr><th>Munsell</th><th>Approximated Colour</th></tr><tr><th>N9.5</th><td><div style="background:#F3F3F3; color: #969696; text-align: center; padding:6px; padding-top:1px; padding-bottom:1px; border: 0px solid;" title="243 243 243"> </div></td></tr><tr><th>N4.74</th><td><div style="background:#757575; color: #CBCBCB; text-align: center; padding:6px; padding-top:1px; padding-bottom:1px; border: 0px solid;" title="97 97 97"> </div></td></tr></tbody></table><h3><br />Calibration Routine</h3><h4><span class="fontstyle0">Reference SPADs Calibration</span></h4><p>There are no specific environmental conditions required for calibrating the reference SPADs. <span class="fontstyle0">If a highly reflective target is covering the VL53L0X module during reference SPAD calibration, the calibration may fail. In this case, user has to move the target away from device.</span></p><h4><span class="fontstyle0">Temperature Calibration</span></h4><p>You will first need to perform the Reference SPAD calibration routine before calibrating temperature. There is no specific environmental conditions required for calibrating the temperature.</p><h4><span class="fontstyle0">Offset Calibration</span></h4><p><span class="fontstyle0">It is recommended to use a white (88% reflectance) target at 100mm, in a dark environment when performing this procedure. Target distance can be changed depending on constraints. You will first need to perform the </span>Reference SPAD and temperature calibration routines before calling the offset calibration routine. This routine should be performed after a glass cover is installed if using a glass cover.</p><p>Once offset calibration has been completed, be sure to write the current settings as the default startup settings.</p><h4>Cross-talk Calibration</h4><p><span class="fontstyle0">You will first need to perform the </span>Reference SPAD, temperature calibration and offset calibration, before calling the cross-talk calibration routine.</p><p><span class="fontstyle0">It is recommended to use a grey (17% reflectance) target in a dark environment when performing this procedure. </span>Next choose the distance required for this target depending on the type of cover being used:</p><figure role="group" class="align-center"><img alt="Crosstalk" data-entity-type="file" data-entity-uuid="ab1fdd5d-d0f9-4a6d-87ee-4add5016d2e9" src="sites/default/files/inline-images/crosstalk.png" /><figcaption><em>Taken from page 9 of VL53L0X Datasheet. More information is located in the <a href="sites/default/files/misc/en.DM00279086.pdf">datasheet</a>.</em></figcaption></figure><p>Once cross-talk calibration has been completed, be sure to write the current settings as the default startup settings.</p><h3>Registers</h3><p>The MappyDot can perform the above VL53L0X API calibration routines using the following configuration registers:</p><ul><li>a (0x61) [<a href="mappydotreg.html">target_distance_bytes</a>] - Calibrate Distance Offset</li><li>x (0x78) [<a href="mappydotreg.html">target_distance_bytes</a>] - Calibrate Crosstalk</li><li>u (0x75) - Calibrate Reference SPAD</li><li>U (0x55) - Temperature Calibration</li></ul><p>If these routines fail, the <a href="ledflash.html">LED will blink</a> a calibration fail code.</p><h3>Code Example</h3><p>Here's an Arduino code sample for performing the offset calibration routine:</p><pre>
#define CALIBRATE_DISTANCE_OFFSET                   (0x61)
#define CALIBRATE_SPAD                              (0x75)
#define TEMPERATURE_CALIBRATION                     (0x55)

void mm_to_bytes(uint8_t *bytes, uint16_t mm)
{
    bytes[0] = (mm &gt;&gt; 8 &amp; 0xFF);
    bytes[1] = (mm &amp; 0xFF);
}

void offset_calibration_routine()
{
  set_led_mode_off();

  delay(500);
  
  /* Calibrate SPADs */
  Wire.beginTransmission(address);
  Wire.write(CALIBRATE_SPAD);
  Wire.endTransmission();

  delay(1000);

  /* Calibrate Temperature */

  Wire.beginTransmission(address);
  Wire.write(TEMPERATURE_CALIBRATION);
  Wire.endTransmission();

  delay(1000);

  /* Calibrate Offset */

  uint8_t calib_dist = 100; //In millimeters
  uint8_t dist_bytes[2];
  mm_to_bytes(dist_bytes, calib_dist);
  Wire.beginTransmission(address);
  Wire.write(CALIBRATE_DISTANCE_OFFSET);
  Wire.write(dist_bytes[0]);
  Wire.write(dist_bytes[1]);
  Wire.endTransmission();

  delay(10000);

  Serial.println("Calibration Complete");
}</pre></div></div></article></div></div></div></div></div></div></div><div class="footer-menu"><div class="container"><div class="row"><div class="col-sm-6 col-md-6"><div class="region region-footer-menu"> <nav role="navigation" aria-labelledby="block-drupal8-zymphonies-theme-footer-menu" id="block-drupal8-zymphonies-theme-footer"><h2 class="visually-hidden" id="block-drupal8-zymphonies-theme-footer-menu">Footer menu</h2><ul class="menu"><li class="menu-item"> <a href="contact.html" data-drupal-link-system-path="contact">Contact</a></li><li class="menu-item"> <a href="disclaimers.html">Disclaimers</a></li><li class="menu-item"> <a href="news.html">News</a></li><li class="menu-item"> <a href="privacy.html">Privacy Policy</a></li><li class="menu-item"> <a href="newsletter/subscriptions.html" data-drupal-link-system-path="newsletter/subscriptions">Subscriptions</a></li></ul> </nav></div></div><div class="col-sm-6 col-md-6"><div class="social-media"> <a href="https://twitter.com/sensordots" class="twitter" target="_blank" ><i class="fab fa-twitter"></i></a> <a href="https://www.linkedin.com/company/18254750/" class="linkedin" target="_blank"><i class="fab fa-linkedin-in"></i></a></div></div></div></div></div><div class="copyright"><div class="container"><div class="row"><div class="col-sm-6 col-md-6"><p>Copyright © SensorDots 2020</p></div></div></div></div></div><script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/27","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"classy\/node,colorbox\/default,colorbox_inline\/colorbox_inline,core\/html5shiv,drupal8_zymphonies_theme\/bootstrap,drupal8_zymphonies_theme\/flexslider,drupal8_zymphonies_theme\/fontawesome,drupal8_zymphonies_theme\/global-components,drupal8_zymphonies_theme\/smartmenus,filter\/caption,system\/base","theme":"drupal8_zymphonies_theme","theme_token":null},"ajaxTrustedUrl":{"\/search\/node":true},"colorbox":{"transition":"elastic","speed":350,"opacity":0.8000000000000000444089209850062616169452667236328125,"slideshow":false,"slideshowAuto":true,"slideshowSpeed":2500,"slideshowStart":"start slideshow","slideshowStop":"stop slideshow","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","overlayClose":true,"returnFocus":true,"maxWidth":"80%","maxHeight":"80%","initialWidth":"300","initialHeight":"250","fixed":true,"scrolling":true,"mobiledetect":true,"mobiledevicewidth":"480px"},"user":{"uid":0,"permissionsHash":"e3ab66e5440975c4c1130bb59a86f381def0e44af11e4b8bc2031e564626f57f"}}</script><script src="../ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script><script src="sites/default/files/js/js_z8MKdK9rPFI4grt3IiJcmfRC3e2SqIgyx3dIX8GONAo.js"></script></body>
<!-- Mirrored from sensordots.org/mappydotcalibration by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 Aug 2022 12:43:54 GMT -->
</html>