<!DOCTYPE html><html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# schema: http://schema.org/ sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# ">
<!-- Mirrored from sensordots.org/node/15 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 Aug 2022 11:22:49 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8" /><meta name="description" content="Auto Addressing
One of the core features behind the SensorDots is the ability for devices in a chain to automatically assign themselves addresses." /><meta name="keywords" content="SensorDots Sensor Dots Small Smart Simple Sensors Filtering Polling Crosstalk Automatic Address Addressing Bus Easy Processing" /><meta name="Generator" content="Drupal 8 (https://www.drupal.org)" /><meta name="MobileOptimized" content="width" /><meta name="HandheldFriendly" content="true" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="../sites/default/files/favicon.ico" type="image/vnd.microsoft.icon" /><link rel="canonical" href="../addressing.html" /><link rel="shortlink" href="15.html" /><link rel="revision" href="../addressing.html" /><title>Auto Addressing | SensorDots</title><link rel="stylesheet" media="all" href="../sites/default/files/css/css_RJqZCut1W0h7YRAwy_VGhC4L7Kaay-HAQBzYzaGiHNA.css" /><link rel="stylesheet" media="all" href="../sites/default/files/css/css_TqP0rzTeinXkupgUr1mR41ebkMj_f9DCOzD1rEBC4ZY.css" /> <!--[if lte IE 8]><script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script><![endif]--></head><body class="path-node page-node-type-page"> <a href="#main-content" class="visually-hidden focusable skip-link"> Skip to main content </a><div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas> <header class="main-header"> <nav class="navbar navbar-default" role="navigation"><div class="container"><div class="row"><div class="navbar-header col-md-3"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><div class="region region-header"><div id="block-drupal8-zymphonies-theme-branding" class="site-branding block block-system block-system-branding-block"><div class="brand logo"> <a href="../index.html" title="Home" rel="home" class="site-branding__logo"> <img src="../sites/default/files/logo-big.png" alt="Home" /> </a></div></div></div></div><div class="col-md-9"><div class="region region-primary-menu"><div class="search-block-form block block-search" data-drupal-selector="search-block-form" id="block-drupal8-zymphonies-theme-search" role="search"><h2 class="visually-hidden">Search</h2><form action="http://sensordots.org/search/node" method="get" id="search-block-form" accept-charset="UTF-8"><div class="js-form-item form-item js-form-type-search form-item-keys js-form-item-keys form-no-label"> <label for="edit-keys" class="visually-hidden">Search</label> <input title="Enter the terms you wish to search for." data-drupal-selector="edit-keys" type="search" id="edit-keys" name="keys" value="" size="15" maxlength="128" class="form-search" /></div><div data-drupal-selector="edit-actions" class="form-actions js-form-wrapper form-wrapper" id="edit-actions"><input data-drupal-selector="edit-submit" type="submit" id="edit-submit" value="Search" class="button js-form-submit form-submit" /></div></form></div><nav role="navigation" aria-labelledby="block-drupal8-zymphonies-theme-main-menu-menu" id="block-drupal8-zymphonies-theme-main-menu"><h2 class="visually-hidden" id="block-drupal8-zymphonies-theme-main-menu-menu">Main navigation</h2><ul class="sm menu-base-theme" id="main-menu" class="menu nav navbar-nav"><li class="active"> <a href="../index.html" data-drupal-link-system-path="&lt;front&gt;">Home</a></li><li> <a href="../about.html" data-drupal-link-system-path="node/2">About</a></li><li> <a href="https://www.tindie.com/stores/blecky/">Store</a></li><li> <a href="../dots.html" data-target="#" data-toggle="dropdown">Dots</a><ul><li> <a href="../mappydot.html" data-drupal-link-system-path="node/3">MappyDot</a></li><li> <a href="../mappydot_plus.html" data-drupal-link-system-path="node/32">MappyDot+</a></li></ul></li><li> <a href="../tools.html" data-target="#" data-toggle="dropdown">Tools</a><ul><li> <a href="../devboard.html" data-drupal-link-system-path="node/9">Dev Board</a></li><li> <a href="../mounting_board.html">Mounting Board</a></li><li> <a href="../port_multiplexer.html">Port MuxR</a></li></ul></li><li> <a href="../docs.html">Docs</a></li><li> <a href="https://github.com/SensorDots">Repo</a></li><li> <a href="https://hackaday.io/project/25571-mappydot">Blog</a></li><li> <a href="../custom.html">Custom Design</a></li></ul> </nav></div></div></div></div> </nav> </header><div class="container"><div class="row"><div class="col-md-12"><div class="region region-highlighted"><div data-drupal-messages-fallback class="hidden"></div></div></div></div></div><div id="wrapper"><div class="container"><div class="row"><div class="col-md-12"></div></div><div class="row layout"><div class="content_layout"><div class=col-md-12><div class="region region-content"><div id="block-drupal8-zymphonies-theme-content" class="block block-system block-system-main-block"> <article data-history-node-id="15" role="article" about="/addressing" typeof="schema:WebPage" class="node node--type-page node--view-mode-full"> <span property="schema:name" content="Auto Addressing" class="hidden"></span><div class="node__content"><div property="schema:text"><h2>Auto Addressing</h2><p>One of the core features behind the SensorDots is the ability for devices in a chain to automatically assign themselves addresses.</p><a class="colorbox cboxElement" href="../sites/default/files/inline-images/Mappyarduino_bb.png" title="Chained SensorDots"><img alt="Chained SensorDots" data-entity-type="file" data-entity-uuid="443ba83b-5e2c-42c4-9073-13ab294db60d" height="242" src="../sites/default/files/inline-images/Mappyarduino_bb.png" width="285" class="align-center" /></a><p>When the SensorDots switch on, all devices go into a discovery state and wait until they receive an address command. All except for the first in the chain which is the master. The master is set by bridging the MST pads or connecting the MST pin to ground. The master will first assign it's own address as 0x08 and then initialise the address protocol:</p><a class="colorbox cboxElement" href="../sites/default/files/inline-images/Newfile2.png" title="Address Protocol from 0x08 to 0x09"><img alt="Address Protocol" data-entity-type="file" data-entity-uuid="936f89ad-2211-4202-b0d9-035f1f47db43" height="296" src="../sites/default/files/inline-images/Newfile2.png" width="493" class="align-center" /></a><p>This address protocol is very simple and is based on the 1wire interface. The master sends the next address to be assigned, the slave then responds with what it thinks its address is then the master will ACK with 0x01 if this is correct (or NACK with 0xFE). If there is a NACK, the master and slave will retry. If there are too many retries, then they will blink an error code.</p><p>Once the slave has got its address, it then begins this process with the next device in the chain while acting as the master.</p><p>So if you now perform an I2C scan, you should see all the devices in the chain (after a few ms depending on the number of devices).</p><a class="colorbox cboxElement" href="../sites/default/files/inline-images/scanning.png" title="Scanning"><img alt="Scanning" data-entity-type="file" data-entity-uuid="91d29054-31d0-43da-ae76-a8e01f7a7087" height="317" src="../sites/default/files/inline-images/scanning.png" width="501" class="align-center" /></a><h3>Custom Address Ranges</h3><p>What if you want to change the address range of the devices, instead of starting at 0x08? Well, that's simple. All you need to do is connect the ADDR_IN pin of the first device in the chain to your microcontroller (as shown in the image below with the cyan wire), and initiate the addressing process with the start address you desire.</p><a class="colorbox cboxElement" href="../sites/default/files/inline-images/Mappyarduino4_bb_0.png" title="Own Addressing Range"><img alt="Own Addressing Range" data-entity-type="file" data-entity-uuid="ad7e1ed3-dfbb-499b-a1e1-1b50da124001" height="242" src="../sites/default/files/inline-images/Mappyarduino4_bb_0.png" width="305" class="align-center" /></a><p>Because it is based on 1 wire, you just perform the 1wire detect presence procedure. If there is presence, then send the address, wait for the response, check that the address matches and send 0x01 for ACK or 0xfe for NACK.The pseudocode for this is as follows:</p><pre>
    //Perform detect presence procedure
    if (1wire_detect_presence())
    {
        //Send start address
        1wire_write_byte(address);

        if (1wire_read_byte() == address)
        {
            //Send ACK
            1wire_write_byte(0x01);

            //Return OK
            return 0;
        } else {
            //Send NACK
            1wire_write_byte(0xfe);

            //Return error; the microcontroller should restart this proceedure again
            return -1;
        }       
    }</pre><p>Example Arduino code for this can be found here - <a href="https://github.com/SensorDots/Testing/tree/master/new_master_addr">https://github.com/SensorDots/Testing/tree/master/new_master_addr</a></p></div><div><a href="../sites/default/files/2017-08/dot_1.png" title="Dot" data-colorbox-gallery="gallery-page-15-Kev8kJotVhM" class="colorbox" data-cbox-img-attrs="{&quot;alt&quot;:&quot;Dot&quot;}"><img src="../sites/default/files/2017-08/dot_1.png" width="1" height="1" alt="Dot" typeof="foaf:Image" /></a></div></div></article></div></div></div></div></div></div></div><div class="footer-menu"><div class="container"><div class="row"><div class="col-sm-6 col-md-6"><div class="region region-footer-menu"> <nav role="navigation" aria-labelledby="block-drupal8-zymphonies-theme-footer-menu" id="block-drupal8-zymphonies-theme-footer"><h2 class="visually-hidden" id="block-drupal8-zymphonies-theme-footer-menu">Footer menu</h2><ul class="menu"><li class="menu-item"> <a href="../contact.html" data-drupal-link-system-path="contact">Contact</a></li><li class="menu-item"> <a href="../disclaimers.html">Disclaimers</a></li><li class="menu-item"> <a href="../news.html">News</a></li><li class="menu-item"> <a href="../privacy.html">Privacy Policy</a></li><li class="menu-item"> <a href="../newsletter/subscriptions.html" data-drupal-link-system-path="newsletter/subscriptions">Subscriptions</a></li></ul> </nav></div></div><div class="col-sm-6 col-md-6"><div class="social-media"> <a href="https://twitter.com/sensordots" class="twitter" target="_blank" ><i class="fab fa-twitter"></i></a> <a href="https://www.linkedin.com/company/18254750/" class="linkedin" target="_blank"><i class="fab fa-linkedin-in"></i></a></div></div></div></div></div><div class="copyright"><div class="container"><div class="row"><div class="col-sm-6 col-md-6"><p>Copyright © SensorDots 2020</p></div></div></div></div></div><script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"node\/15","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"classy\/node,colorbox\/default,colorbox_inline\/colorbox_inline,core\/html5shiv,drupal8_zymphonies_theme\/bootstrap,drupal8_zymphonies_theme\/flexslider,drupal8_zymphonies_theme\/fontawesome,drupal8_zymphonies_theme\/global-components,drupal8_zymphonies_theme\/smartmenus,system\/base","theme":"drupal8_zymphonies_theme","theme_token":null},"ajaxTrustedUrl":{"\/search\/node":true},"colorbox":{"transition":"elastic","speed":350,"opacity":0.8,"slideshow":false,"slideshowAuto":true,"slideshowSpeed":2500,"slideshowStart":"start slideshow","slideshowStop":"stop slideshow","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","overlayClose":true,"returnFocus":true,"maxWidth":"80%","maxHeight":"80%","initialWidth":"300","initialHeight":"250","fixed":true,"scrolling":true,"mobiledetect":true,"mobiledevicewidth":"480px"},"user":{"uid":0,"permissionsHash":"e3ab66e5440975c4c1130bb59a86f381def0e44af11e4b8bc2031e564626f57f"}}</script><script src="../../ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script><script src="../sites/default/files/js/js_z8MKdK9rPFI4grt3IiJcmfRC3e2SqIgyx3dIX8GONAo.js"></script></body>
<!-- Mirrored from sensordots.org/node/15 by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 25 Aug 2022 11:22:49 GMT -->
</html>